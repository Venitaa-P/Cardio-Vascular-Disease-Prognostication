<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Prediction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background-image: url('static/29135.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-repeat: no-repeat;
            color: white;
        }
        .overlay {
            background-color: rgba(0, 0, 0, 0.6);
            min-height: 100vh;
            padding: 2rem;
        }
        .form-container, .result-container {
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
            max-width: 800px;
            width: 100%;
        }
        .form-title, .result-title {
            font-size: 32px;
            color: white;
            margin-bottom: 25px;
            font-weight: 700;
            text-align: center;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        .form-group {
            margin-bottom: 20px;
            color: black;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: white;
        }
        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            transition: border 0.3s;
            background-color: rgba(255, 255, 255, 0.9);
        }
        .form-input:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        .btn {
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 16px;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(123, 111, 214, 0.1);
            border: none;
            cursor: pointer;
            display: inline-block;
            text-align: center;
        }
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        .btn-secondary {
            background-color: #2c3e50;
            color: white;
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }
        .prediction-box {
            font-size: 36px;
            font-weight: 800;
            padding: 25px;
            border-radius: 12px;
            margin: 20px auto;
            max-width: 400px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .low-risk {
            color: #27ae60;
            border: 4px solid #27ae60;
            background-color: rgba(234, 250, 241, 0.2);
        }
        .medium-risk {
            color: #f39c12;
            border: 4px solid #f39c12;
            background-color: rgba(254, 248, 236, 0.2);
        }
        .high-risk {
            color: #e74c3c;
            border: 4px solid #e74c3c;
            background-color: rgba(253, 237, 236, 0.2);
        }
        .probability {
            font-size: 24px;
            font-weight: 600;
            margin: 20px 0;
            color: white;
            text-align: center;
        }
        .btn-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            box-shadow: #3498db;
        }
        .chat-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 30px;
            max-width: 800px;
            width: 100%;
        }
        .chat-header {
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            color: white;
            padding: 20px;
        }
        .chat-title {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chat-subtitle {
            font-size: 14px;
            opacity: 0.9;
            margin-top: 5px;
        }
        .chat-messages {
            height: 350px;
            overflow-y: auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        .bot-message {
            flex-direction: row;
        }
        .user-message {
            flex-direction: row-reverse;
        }
        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        .bot-avatar {
            background-color: #3498db;
        }
        .user-avatar {
            background-color: #2ecc71;
        }
        .message-content {
            max-width: 70%;
            padding: 15px;
            border-radius: 18px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .bot-content {
            background-color: white;
            border-top-left-radius: 5px;
            color: #2c3e50;
        }
        .user-content {
            background-color: #3498db;
            color: white;
            border-top-right-radius: 5px;
        }
        .typing-indicator {
            display: none;
            padding: 15px 20px;
            align-items: center;
            gap: 12px;
        }
        .typing-indicator.visible {
            display: flex;
        }
        .typing-dots {
            display: flex;
            gap: 5px;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #3498db;
            animation: typing 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid #eaeaea;
            background-color: white;
        }
        .input-group {
            display: flex;
            gap: 10px;
        }
        .chat-input {
            flex: 1;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            outline: none;
            transition: border 0.3s;
            color: #3498db !important;
        }
        .chat-input::placeholder {
            color: #3498db !important;
            opacity: 0.8;
        }
        .chat-input:focus {
            border-color: #3498db;
        }
        .send-btn {
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 0 25px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: 600;
        }
        .send-btn:hover {
            background-color: #2980b9;
        }
        .disclaimer {
            font-size: 12px;
            color: #7f8c8d;
            margin-top: 10px;
            text-align: center;
        }
        .suggestions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        .suggestion-btn {
            background-color: #ecf0f1;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 13px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-align: left;
            color: #2c3e50;
        }
        .suggestion-btn:hover {
            background-color: #d5dbdb;
        }
        header {
            margin-bottom: 2rem;
            width: 100%;
            max-width: 1200px;
        }
        nav ul {
            display: flex;
            justify-content: center;
            padding: 1rem 0;
        }
        nav li {
            margin: 0 1.5rem;
        }
        nav a {
            color: white;
            font-weight: 500;
            text-decoration: none;
            transition: color 0.3s;
            font-size: 1.1rem;
        }
        nav a:hover {
            color: #3498db;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 768px) {
            nav ul {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            .btn-container {
                flex-direction: column;
                align-items: center;
            }
            .btn {
                width: 100%;
                max-width: 300px;
            }
            .suggestions {
                grid-template-columns: 1fr;
            }
            .message-content {
                max-width: 85%;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="overlay w-full flex flex-col items-center">
        <header>
            <nav>
    <ul>
        {% if session.user %}
            <li><a href="/main">Home</a></li>
            <li><a href="/chatbot">predict and AI Advisor</a></li>   <!-- Add this line -->
            <li><a href="/about">About</a></li>
            
            <li><a href="/logout">Logout</a></li>
        {% else %}
            <li><a href="/signin">Sign In</a></li>
        {% endif %}
    </ul>
</nav>
        </header>

        <!-- Input Form -->
        <div id="input-form" class="form-container">
            <h1 class="form-title">Heart Disease Risk Prediction</h1>
            
            <form id="prediction-form">
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="age">Age</label>
                        <input type="number" class="form-input" id="age" name="age" min="1" max="120" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="gender">Gender</label>
                        <select class="form-input" id="gender" name="gender" required>
                            <option value="">Select Gender</option>
                            <option value="0">Female</option>
                            <option value="1">Male</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="chest-pain">Chest Pain Type</label>
                        <select class="form-input" id="chest-pain" name="chest-pain" required>
                            <option value="">Select Chest Pain Type</option>
                            <option value="1">Typical Angina</option>
                            <option value="2">Atypical Angina</option>
                            <option value="3">Non-anginal Pain</option>
                            <option value="4">Asymptomatic</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="resting-bp">Resting Blood Pressure (mm Hg)</label>
                        <input type="number" class="form-input" id="resting-bp" name="resting-bp" min="80" max="200" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="cholesterol">Cholesterol (mg/dl)</label>
                        <input type="number" class="form-input" id="cholesterol" name="cholesterol" min="100" max="600" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="fasting-bs">Fasting Blood Sugar > 120 mg/dl</label>
                        <select class="form-input" id="fasting-bs" name="fasting-bs" required>
                            <option value="">Select</option>
                            <option value="0">No</option>
                            <option value="1">Yes</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="resting-ecg">Resting ECG Results</label>
                        <select class="form-input" id="resting-ecg" name="resting-ecg" required>
                            <option value="">Select ECG Results</option>
                            <option value="0">Normal</option>
                            <option value="1">ST-T Wave Abnormality</option>
                            <option value="2">Left Ventricular Hypertrophy</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="max-hr">Max Heart Rate Achieved</label>
                        <input type="number" class="form-input" id="max-hr" name="max-hr" min="60" max="220" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="exercise-angina">Exercise Induced Angina</label>
                        <select class="form-input" id="exercise-angina" name="exercise-angina" required>
                            <option value="">Select</option>
                            <option value="0">No</option>
                            <option value="1">Yes</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="oldpeak">ST Depression (Oldpeak)</label>
                        <input type="number" class="form-input" id="oldpeak" name="oldpeak" min="0" max="10" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="st-slope">ST Slope</label>
                        <select class="form-input" id="st-slope" name="st-slope" required>
                            <option value="">Select ST Slope</option>
                            <option value="1">Upsloping</option>
                            <option value="2">Flat</option>
                            <option value="3">Downsloping</option>
                        </select>
                    </div>
                </div>
                
                <div class="btn-container">
                    <button type="submit" class="btn btn-primary">Predict Heart Disease Risk</button>
                    <button type="reset" class="btn btn-secondary">Reset Form</button>
                </div>
            </form>
        </div>

        <!-- Result Section (Initially Hidden) -->
        <div id="result-section" class="result-container" style="display: none;">
            <h1 class="result-title">Heart Disease Prediction Result</h1>
            
            <div id="prediction-box" class="prediction-box fade-in">
                <!-- Dynamic content will be inserted here -->
            </div>
            
            <div id="probability" class="probability">
                <!-- Dynamic content will be inserted here -->
            </div>
            
            <div class="btn-container">
                <button id="new-prediction" class="btn btn-primary">New Prediction</button>
                <a href="/" class="btn btn-secondary">Home</a>
            </div>
        </div>

        <!-- AI Health Advisor Chatbot -->
        <div class="chat-container">
            <div class="chat-header">
                <div class="chat-title">
                    <i class="fas fa-robot"></i>
                    AI Health Advisor
                </div>
                <div class="chat-subtitle">
                    Ask me about heart health, prevention, or your results
                </div>
            </div>
            
            <!-- Chat Messages Container -->
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message fade-in">
                    <div class="avatar bot-avatar">
                        <i class="fas fa-robot" style="color: white;"></i>
                    </div>
                    <div class="message-content bot-content">
                        <p>Hello! I'm your AI Health Advisor. I can help answer questions about heart health, prevention strategies, or explain your prediction results. How can I assist you today?</p>
                        
                        <div class="suggestions">
                            <button class="suggestion-btn" onclick="askQuestion('What does my prediction result mean?')">What does my prediction result mean?</button>
                            <button class="suggestion-btn" onclick="askQuestion('How can I improve my heart health?')">How can I improve my heart health?</button>
                            <button class="suggestion-btn" onclick="askQuestion('What are common heart disease symptoms?')">What are common heart disease symptoms?</button>
                            <button class="suggestion-btn" onclick="askQuestion('What lifestyle changes help prevent heart disease?')">What lifestyle changes help prevent heart disease?</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Typing Indicator with Blue Dots -->
            <div class="typing-indicator" id="typing-indicator">
                <div class="avatar bot-avatar">
                    <i class="fas fa-robot" style="color: white;"></i>
                </div>
                <div class="message-content bot-content">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            </div>
            
            <!-- Chat Input - Inside AI Health Advisor Box -->
            <div class="chat-input-container">
                <div class="input-group">
                    <input 
                        type="text" 
                        class="chat-input" 
                        id="chat-input" 
                        placeholder="Ask about heart health, prevention, or your results..."
                        onkeypress="handleKeyPress(event)"
                    >
                    <button class="send-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                </div>
                <p class="disclaimer">
                    Note: This AI provides general health information only. Always consult healthcare professionals for medical advice.
                </p>
            </div>
        </div>
    </div>

    <script>
        
    // Store health context from the prediction
    let healthContext = {
        riskLevel: "No prediction yet",
        probability: "N/A",
        riskClass: ""
    };

    // Dynamic responses based on actual prediction results
    function getResponses(healthContext) {
        const riskLevel = healthContext.riskLevel;
        const probability = healthContext.probability;
        
        return {
            "What does my prediction result mean?": `Your prediction result of '${riskLevel}' with a ${probability}% probability means that based on the information provided, you have ${getRiskExplanation(riskLevel, probability)}. ${getRecommendationBasedOnRisk(riskLevel)}`,
            
            "How can I improve my heart health?": `${getPersonalizedHealthAdvice(riskLevel)} To generally improve heart health: 1) Eat a balanced diet rich in fruits, vegetables, and whole grains, 2) Exercise regularly (at least 150 minutes per week), 3) Maintain a healthy weight, 4) Avoid smoking and limit alcohol, 5) Manage stress, and 6) Monitor blood pressure and cholesterol levels.`,
            
            "What are common heart disease symptoms?": "Common heart disease symptoms include: chest pain or discomfort, shortness of breath, pain in the neck, jaw, throat, upper abdomen or back, pain, numbness, weakness or coldness in legs or arms, and fatigue. However, some people may have no symptoms until a heart attack occurs.",
            
            "What lifestyle changes help prevent heart disease?": `${getPersonalizedPreventionAdvice(riskLevel)} Key lifestyle changes to prevent heart disease: 1) Quit smoking, 2) Follow a heart-healthy diet (Mediterranean or DASH diet), 3) Maintain a healthy weight, 4) Exercise regularly, 5) Limit alcohol, 6) Manage stress through meditation or yoga, 7) Get 7-9 hours of quality sleep nightly, and 8) Regular health screenings.`,
            
            "What is a healthy blood pressure range?": "A healthy blood pressure is typically below 120/80 mm Hg. Elevated blood pressure is 120-129/<80, stage 1 hypertension is 130-139/80-89, and stage 2 hypertension is 140/90 or higher. Regular monitoring is important.",
            
            "How often should I get my cholesterol checked?": "Adults should have their cholesterol checked every 4-6 years. Those with risk factors for heart disease may need more frequent testing. Consult your doctor for personalized recommendations.",
            
            "What foods are good for heart health?": "Heart-healthy foods include: fatty fish (salmon, mackerel), nuts and seeds, berries, oats, dark leafy greens, beans, dark chocolate (in moderation), and olive oil. Limit processed foods, saturated fats, and added sugars.",
            
            "Should I see a doctor?": `${getDoctorRecommendation(riskLevel)} ${riskLevel === "High Risk" ? "It's important to consult with a healthcare professional as soon as possible for proper evaluation and management." : "Regular check-ups are always recommended for maintaining heart health."}`,
            
            "What exercises are best for heart health?": "Aerobic exercises are excellent for heart health: brisk walking, jogging, swimming, cycling, and dancing. Aim for at least 150 minutes of moderate-intensity or 75 minutes of vigorous-intensity exercise per week, plus strength training twice weekly."
        };
    }

    // Helper functions for personalized responses
    function getRiskExplanation(riskLevel, probability) {
        switch(riskLevel) {
            case "Low Risk":
                return `a relatively low likelihood (${probability}%) of developing heart disease in the near future`;
            case "Medium Risk":
                return `a moderate likelihood (${probability}%) of developing heart disease, indicating some risk factors that should be addressed`;
            case "High Risk":
                return `a significant likelihood (${probability}%) of developing heart disease, suggesting immediate attention to risk factors is needed`;
            default:
                return "an unknown risk level. Please complete the prediction form first";
        }
    }

    function getRecommendationBasedOnRisk(riskLevel) {
        switch(riskLevel) {
            case "Low Risk":
                return "It's important to maintain your current healthy habits and continue with regular check-ups.";
            case "Medium Risk":
                return "Consider making some lifestyle changes and discuss these results with your healthcare provider.";
            case "High Risk":
                return "We strongly recommend consulting with a healthcare professional promptly to discuss these results and develop a management plan.";
            default:
                return "Please complete the prediction form to get personalized recommendations.";
        }
    }

    function getPersonalizedHealthAdvice(riskLevel) {
        switch(riskLevel) {
            case "Low Risk":
                return "Since you're at low risk, focus on maintaining your healthy habits. ";
            case "Medium Risk":
                return "Given your medium risk level, you should prioritize improving your cardiovascular health through targeted lifestyle changes. ";
            case "High Risk":
                return "Due to your high risk level, immediate and significant lifestyle modifications are crucial. ";
            default:
                return "";
        }
    }

    function getPersonalizedPreventionAdvice(riskLevel) {
        switch(riskLevel) {
            case "Low Risk":
                return "To maintain your low risk status, continue with your current prevention strategies. ";
            case "Medium Risk":
                return "To reduce your medium risk level, focus on addressing your specific risk factors. ";
            case "High Risk":
                return "Given your high risk level, aggressive prevention strategies are recommended. ";
            default:
                return "";
        }
    }

    function getDoctorRecommendation(riskLevel) {
        switch(riskLevel) {
            case "Low Risk":
                return "While your risk is low, regular preventive care is still important. ";
            case "Medium Risk":
                return "It would be beneficial to discuss these results with your doctor. ";
            case "High Risk":
                return "Yes, we strongly recommend scheduling an appointment with your doctor soon. ";
            default:
                return "Consulting with a healthcare professional is always a good idea. ";
        }
    }

    // Form submission handler
    document.getElementById('prediction-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Collect form data
        const formData = new FormData(this);
        const data = {};
        for (const [key, value] of formData.entries()) {
            data[key] = value;
        }
        
        // Simulate prediction processing
        simulatePrediction(data);
    });

    // New prediction button handler
    document.getElementById('new-prediction').addEventListener('click', function() {
        document.getElementById('result-section').style.display = 'none';
        document.getElementById('input-form').style.display = 'block';
    });

    // Simulate prediction model (in a real app, this would be a server call)
    function simulatePrediction(data) {
        // Show loading state
        const submitBtn = document.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.textContent = 'Processing...';
        submitBtn.disabled = true;
        
        // Simulate API delay
        setTimeout(() => {
            // Calculate risk based on inputs (simplified algorithm for demo)
            let riskScore = 0;
            
            // Age factor
            if (data.age > 50) riskScore += 20;
            else if (data.age > 40) riskScore += 10;
            
            // Gender factor
            if (data.gender === '1') riskScore += 5; // Male
            
            // Chest pain factor
            if (data['chest-pain'] === '4') riskScore += 25; // Asymptomatic
            else if (data['chest-pain'] === '3') riskScore += 15; // Non-anginal
            
            // Blood pressure factor
            if (data['resting-bp'] > 140) riskScore += 15;
            else if (data['resting-bp'] > 130) riskScore += 10;
            
            // Cholesterol factor
            if (data.cholesterol > 240) riskScore += 20;
            else if (data.cholesterol > 200) riskScore += 10;
            
            // Blood sugar factor
            if (data['fasting-bs'] === '1') riskScore += 10;
            
            // Max heart rate factor
            if (data['max-hr'] < 120) riskScore += 15;
            else if (data['max-hr'] < 140) riskScore += 5;
            
            // Exercise angina factor
            if (data['exercise-angina'] === '1') riskScore += 20;
            
            // Oldpeak factor
            if (data.oldpeak > 2) riskScore += 15;
            else if (data.oldpeak > 1) riskScore += 10;
            
            // ST slope factor
            if (data['st-slope'] === '3') riskScore += 20; // Downsloping
            else if (data['st-slope'] === '2') riskScore += 10; // Flat
            
            // Calculate probability (simplified)
            let probability = Math.min(95, Math.max(5, riskScore));
            
            // Determine risk level
            let riskLevel, riskClass;
            if (probability < 30) {
                riskLevel = "Low Risk";
                riskClass = "low-risk";
            } else if (probability < 60) {
                riskLevel = "Medium Risk";
                riskClass = "medium-risk";
            } else {
                riskLevel = "High Risk";
                riskClass = "high-risk";
            }
            
            // Update health context for chatbot
            healthContext = {
                riskLevel: riskLevel,
                probability: probability,
                riskClass: riskClass
            };
            
            // Update result display
            document.getElementById('prediction-box').textContent = riskLevel;
            document.getElementById('prediction-box').className = `prediction-box ${riskClass} fade-in`;
            document.getElementById('probability').textContent = `Prediction Probability: ${probability}%`;
            
            // Show results and hide form
            document.getElementById('input-form').style.display = 'none';
            document.getElementById('result-section').style.display = 'block';
            
            // Reset button state
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }, 1500);
    }

    // Chatbot functions
    function handleKeyPress(event) {
        if (event.key === 'Enter') {
            sendMessage();
        }
    }

    function sendMessage() {
        const input = document.getElementById('chat-input');
        const message = input.value.trim();
        
        if (!message) return;

        // Add user message to chat
        addMessage(message, 'user');
        input.value = '';

        // Show typing indicator
        showTypingIndicator();

        // Simulate API call with timeout
        setTimeout(() => {
            hideTypingIndicator();
            
            const dynamicResponses = getResponses(healthContext);
const msg = message.toLowerCase();
let response = "I'm here to help with heart health. Ask about diet, exercise, symptoms, prevention, or your results.";

if (msg.includes("result") || msg.includes("prediction")) {
    response = dynamicResponses["What does my prediction result mean?"];
}
else if (msg.includes("improve") || msg.includes("healthy")) {
    response = dynamicResponses["How can I improve my heart health?"];
}
else if (msg.includes("symptom")) {
    response = dynamicResponses["What are common heart disease symptoms?"];
}
else if (msg.includes("prevent") || msg.includes("lifestyle")) {
    response = dynamicResponses["What lifestyle changes help prevent heart disease?"];
}
else if (msg.includes("blood pressure")) {
    response = dynamicResponses["What is a healthy blood pressure range?"];
}
else if (msg.includes("cholesterol")) {
    response = dynamicResponses["How often should I get my cholesterol checked?"];
}
else if (msg.includes("food") || msg.includes("diet")) {
    response = dynamicResponses["What foods are good for heart health?"];
}
else if (msg.includes("exercise") || msg.includes("workout")) {
    response = dynamicResponses["What exercises are best for heart health?"];
}
else if (msg.includes("doctor")) {
    response = dynamicResponses["Should I see a doctor?"];
}
else {
    response = "I can help with heart health, diet, exercise, symptoms, prevention, or explaining your prediction results. Try asking about one of these ðŸ™‚";
}


            
            addMessage(response, 'bot');
        }, 1500);
    }

    function addMessage(text, sender) {
        const chatMessages = document.getElementById('chat-messages');
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${sender}-message fade-in`;
        
        const avatarClass = sender === 'user' ? 'user-avatar' : 'bot-avatar';
        const contentClass = sender === 'user' ? 'user-content' : 'bot-content';
        const icon = sender === 'user' ? 'fa-user' : 'fa-robot';
        
        messageDiv.innerHTML = `
            <div class="avatar ${avatarClass}">
                <i class="fas ${icon}" style="color: white;"></i>
            </div>
            <div class="message-content ${contentClass}">
                <p>${text}</p>
            </div>
        `;
        
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }

    function askQuestion(question) {
        document.getElementById('chat-input').value = question;
        sendMessage();
    }

    function showTypingIndicator() {
        document.getElementById('typing-indicator').classList.add('visible');
        document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
    }

    function hideTypingIndicator() {
        document.getElementById('typing-indicator').classList.remove('visible');
    }
</script>

</body>
</html>